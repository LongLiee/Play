@*
* This template takes a single argument, a String containing a
* message to display.
*@
@import play.api.libs.json.JsValue
@(message: String,jsonData:JsValue)

    @*
    * Call the `main` template with two arguments. The first
    * argument is a `String` with the title of the page, the second
    * argument is an `Html` object containing the body of the page.
    *@
   @* @main("Welcome to Play", welcome(message, style = "scala"),chartData)) {

    }*@
<!DOCTYPE html>
<html lang="en">
    <head>
        @* Here's where we render the page title `String`. *@
        <title>@message</title>
        <link rel="stylesheet" media="screen" href="@routes.Assets.versioned("stylesheets/main.css")">
        <link rel="shortcut icon" type="image/png" href="@routes.Assets.versioned("images/favicon.png")">
        <script src="https://code.highcharts.com/highcharts.js"></script>
    </head>
    <body>
        <figure class="highcharts-figure">
            <div id="container"></div>
            <p class="highcharts-description">
                Basic line chart showing trends in a dataset. This chart includes the
                <code>series-label</code> module, which adds a label to each line for
                enhanced readability.
            </p>
        </figure>
        <div class="select--tag">
            <select id="category" >
                <option value="All">All category</option>
                <option value="MenClo">Men's Clothing</option>
                <option value="WomenClo">Women's Clothing</option>
            </select>
            <select id="days">
                <option value="sevenDays">7 days</option>
                <option value="threeDays">3 days</option>
                <option value="oneDay">1 day</option>
            </select>
        </div>
     <button onclick="filterData()">Apply</button>
        <script type="text/javascript">
                var chart
                var objData = @Html(jsonData.toString())
                // ---------------------------------------------------------------------
               //  var menClothing = objData.category_types.buckets[0].each_day.buckets
               //  var nameMenClothing = objData.category_types.buckets[0].key
                //  var womenClothing = objData.category_types.buckets[1].each_day.buckets
                //  var nameWomenClothing = objData.category_types.buckets[1].key
               //  // ---------------------------------------------------------------------
               //  var dataMenClothing = [objData[0][0].doc_count,objData[0][1].doc_count,objData[0][2].doc_count,
               //  ,objData[0][3].doc_count,objData[0][4].doc_count,objData[0][5].doc_count,objData[0][6].doc_count]

                         var dataMenClothing = [objData[0][0].doc_count,objData[0][1].doc_count,objData[0][2].doc_count,
                             objData[0][3].doc_count,objData[0][4].doc_count,objData[0][5].doc_count,objData[0][6].doc_count
                         ]




                console.log(dataMenClothing)
                console.log(typeof dataMenClothing)



                var timeLine = [objData[0][0].key_as_string,objData[0][1].key_as_string,objData[0][2].key_as_string,
                    objData[0][3].key_as_string,objData[0][4].key_as_string,objData[0][5].key_as_string,objData[0][6].key_as_string,]
                var dataWomenClothing = [objData[1][0].doc_count,objData[1][1].doc_count,objData[1][2].doc_count,objData[1][3].doc_count,
                    objData[1][4].doc_count,objData[1][5].doc_count,objData[1][6].doc_count]

                var series =[{
                    id:1,
                    name: "Men's Clothing",
                    data: dataMenClothing
                },
                    {
                        id:2,
                        name: "Women's Clothing",
                        data: dataWomenClothing
                    }
                ]


               var filterData =  function() {
                   var valueCategory = getValueCategory();
                   var valueDay = getValueDays()
                   console.log("----Category------",valueCategory)
                   console.log("----Day------",valueDay)
                   if (valueCategory == "All" && valueDay == "sevenDays"){
                       rerenderUI(series)
                   } else if ( valueCategory == "All" && valueDay == "threeDays" ) {
                       rerenderUI([{
                           id:1,
                           name: "Men's Clothing" ,
                           data: dataMenClothing.slice(0,3)
                       },
                           {
                               id:2,
                               name: "Women's Clothing",
                               data: dataWomenClothing.slice(0,3)
                           }
                       ])
                   }  else if ( valueCategory == "All" && valueDay == "oneDay" ) {
                       rerenderUI([{
                           id:1,
                           name: "Men's Clothing",
                           data: dataMenClothing.slice(0,1)
                       },
                           {
                               id:2,
                               name: "Women's Clothing",
                               data: dataWomenClothing.slice(0,1)
                           }
                       ])
                   } else if ( valueCategory == "MenClo" && valueDay == "sevenDays"){
                       rerenderUI(newData = [{
                           id:1,
                           name: "Men's Clothing",
                           data: dataMenClothing
                       }])
                   } else if ( valueCategory == "MenClo" && valueDay == "threeDays" ) {
                       rerenderUI(newData = [{
                           id:1,
                           name: "Men's Clothing",
                           data: dataMenClothing.slice(0,3)
                       }])
                   }
                   else if ( valueCategory == "MenClo" && valueDay == "oneDay" ) {
                       rerenderUI(newData = [{
                           id:1,
                           name: "Men's Clothing",
                           data: dataMenClothing.slice(0,1)
                       }])
                   }
                   else if ( valueCategory == "WomenClo" && valueDay == "sevenDays" ) {
                       rerenderUI(newData = [{
                           id:1,
                           name: "Women's Clothing",
                           data: dataWomenClothing
                       }])
                   }
                   else if ( valueCategory == "WomenClo" && valueDay == "threeDays" ) {
                       rerenderUI(newData = [{
                           id:1,
                           name: "Women's Clothing",
                           data: dataWomenClothing.slice(0,3)
                       }])
                   }
                   else if ( valueCategory == "WomenClo" && valueDay == "oneDay" ) {
                       rerenderUI(newData = [{
                           id:1,
                           name: "Women's Clothing",
                           data: dataWomenClothing.slice(0,1)
                       }])
                   } else {
                       console.log("Something else")
                   }

               }

                function rerenderUI(dataCategory) {
                    var seriesLength = chart.series.length;

                    for(var i = 1; i <= seriesLength ; i++){
                        chart.get(i).remove();
                    }
                    for (var y = dataCategory.length-1; y >= 0; y--) {
                        chart.addSeries(dataCategory[y]);
                    }

                }

                function getValueCategory(){
                    var eleSelected = document.getElementById("category")
                    var valueSelected = eleSelected.options[eleSelected.selectedIndex].value;
                    return valueSelected
                }
                function getValueDays(){
                    var daySelected = document.getElementById("days")
                    var valueDay = daySelected.options[daySelected.selectedIndex].value;
                    return valueDay
                }
        </script>
        <script type="module">
             chart = Highcharts.chart('container', {
                    title: {
                        text: 'Solar Employment Growth by Sector, 2010-2016'
                    },

                    subtitle: {
                        text: 'Source: thesolarfoundation.com'
                    },

                    yAxis: {
                        title: {
                            text: 'Number of Employees'
                        }
                    },
                    xAxis: {
                        type: 'datetime',
                        // accessibility: {
                        //     rangeDescription: 'Range: 2010 to 2017'
                        // }
                        categories: timeLine

                    },
                 // plotOptions: {
                 //     series: {
                 //         pointStart: Date.UTC(2010, 11, 12),
                 //         pointInterval: 24 * 3600 * 1000 // one day
                 //     }
                 // },

                    legend: {
                        layout: 'vertical',
                        align: 'right',
                        verticalAlign: 'middle'
                    },


                    series: series,

                    responsive: {
                        rules: [{
                            condition: {
                                maxWidth: 500
                            },
                            chartOptions: {
                                legend: {
                                    layout: 'horizontal',
                                    align: 'center',
                                    verticalAlign: 'bottom'
                                }
                            }
                        }]
                    }

                });


        </script>


        @* And here's where we render the `Html` object containing
        * the page content. *@
        @* @content
        @text*@

    </body>
</html>